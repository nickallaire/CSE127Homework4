# CSE127: Introduction to Computer Security Homework 4 

Project Overview: The goal of this assignment is to gain a hands-on experience with the effects of buffer overflows and memory-safety bugs. There are 5 vulernable programs that can be exploited by:

	1. Taking advantage of buffer overflow. A large string is created by the first 300 bytes being NOP's, and then the next 500 bytes contain the shellcode repeated over and over again, and finally the rest of the string is filled with a return address which is an address located within the buffer that the string created is copied into. This causes control to jump into the buffer, which will start at the NOP sled and continue until the shell code is executed, changing control from student to root.

	2. Taking advantage of the for loop range. The for loop goes from 0 to len, instead of 0 to len - 1, which means that 1 bytes can be overwritten outside of the string "out". The string created is 112 bytes long and consists of 40 NOP's, followed by the shell code, and then an address repeated until the end of the string. The very last byte of the string is a 1 byte hex value, 0xa0. This hex value gets written into the last byte of the frame pointer, which is a value less than the current frame pointer. This allows the frame pointer to jump into the buffer where the address of the shell code is loceated. The shell code will then execute, changing control from student to root.

	3. Taking advantage of converting a string to an unsigned long and then casting it to an int. This allows us to create a very large positive number, close to overflowing it, When casted to an it, we get a large negative number because an int is signed and the most significant bit of the number is a 1. The program checks for a value less than 905 and since we have a large negative number we can proceed into the if statement. The large negative nmber is then multiplied by 905 * sizeof(widget_t). This multiplication causes the large negative number to overflow and go to a small positive number. We can then generate a string such that we can cause overflow and go to a small positive number. Finally you can generate a string such that you cause overflow of the buffer. This overflow changes the return address to an address inside the buffer. This address contains the shellcode, which is then executed, changing control from student to root.

	4. Did not attempt

	5. Taking advantage of the concept of snprintf and format strings. The format string created starts with the first byte of the return address. Following that is a 4 byte address of NOP's. This concept repeates for the 4 bytes of the return address. Then starts the format part of the string. Since no variables were put in the snprintf call, the first %x will pop the next value off the stack where the snprintf stack ointer is at. Only 1 %x is needed to get the snprintf stack pointer to be pointing to the first byte of the buffer, which contains the first byte address of the return address. Then %n is used to write the amount of bytes written in the string so far to the address located at the snprintf stack pointer. This concept allows us to rewrite the return address to an address inside the buffer where the shellcode is located. Using %154x allows us to write into the 2nd byte of the return address. This process is repeated until all 4 bytes of the return address is overwritten to the address of the shellcode in the buffer. 
